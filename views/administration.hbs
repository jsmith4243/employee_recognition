<html lang="en">

  <title>{{title}}</title>
  
  <link rel ='stylesheet' href='stylesheets/style.css' />
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  
  
  
  <script>
  
  
    $(document).ready(function()
    {
    
    


      $("#createuserbutton").click(function() {

        var username = $("#username").val();
        
        var password = $("#password").val();
        
        var firstname = $("#firstname").val();
        
        var lastname = $("#lastname").val();

        var name = $("#name").val();
      
        var httpRequest = new XMLHttpRequest();
      
        if (!httpRequest) 
        {
          alert('Giving up : Cannot create an XMLHTTP instance');
          return false;
        }






      
        httpRequest.open('POST', '/register', true);

        httpRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

        httpRequest.send("username="+username+"&password="+password+"&name="+name); //post attributes here, id is a javascript variable appended

   
    

      });
      
      $("#deleteuserbutton").click(function() {

        var userid = $("#userid").val();
      
        var httpRequest = new XMLHttpRequest();
      
        if (!httpRequest) 
        {
          alert('Giving up : Cannot create an XMLHTTP instance');
          return false;
        }

        httpRequest.onreadystatechange = function(){
      
          if (httpRequest.readyState === XMLHttpRequest.DONE) 
          {

            if (httpRequest.status === 200) 
            {


              location.reload(true);


            }


          }


        }
      
        httpRequest.open('POST', '/deleteuser', true);

        httpRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

        httpRequest.send("userid="+userid);

   
    

      });
      
      var httpRequest = new XMLHttpRequest();
      
      if (!httpRequest) 
      {
          alert('Giving up : Cannot create an XMLHTTP instance');
          return false;
      }
      
      httpRequest.onreadystatechange = function(){
      
        if (httpRequest.readyState === XMLHttpRequest.DONE) 
        {

          if (httpRequest.status === 200) 
          {
          
            //alert(httpRequest.responseText); //if its json you call JSON parse to get a json object which is same as javascript object
            var arr = JSON.parse(httpRequest.responseText);
            
           $("#usertable").empty();
           
           var examplefirstname = "examplefirstname";
           var examplelastname = "examplelastname";
           
           
           for(i = 0; i < arr.length; i++)
           {
             $("#usertable").append("<tr>" + "<th scope=row>" + arr[i].id + "</th>"+  "<td>" + arr[i].isadmin + "</td>" +  "<td>" + arr[i].username + "</td>" + "<td>" + arr[i].name + "</td>"   + "<td><button type=\"button\" class=\"btn btn-default tableeditbutton\"  userid=\"" + arr[i].id + "\"   id=\"tableeditbutton\" username=\"" + arr[i].username + "\" name=\"" + arr[i].name + "\" lastname=\"" + arr[i].lastname + "\" >Edit</button></td>" + "<td><button type=\"button\" class=\"btn btn-default tabledeletebutton\" userid=\"" + arr[i].id + "\"  id=\"tabledeletebutton\" >Delete</button></td>" +  "</tr>");
           }
           
           $(".tabledeletebutton").click(function() {

             console.log("tabledeletebutton clicked");
             
             var id;
             
             id = $(this).attr("userid");
             
             console.log("userid is: " + id);
             
             
             
             var httpRequest = new XMLHttpRequest();
      
             if (!httpRequest) 
             {
               alert('Giving up : Cannot create an XMLHTTP instance');
               return false;
             }

              httpRequest.onreadystatechange = function(){
      
                if (httpRequest.readyState === XMLHttpRequest.DONE) 
                {

                  if (httpRequest.status === 200) 
                  {


                    location.reload(true);


                  }


                }


              }
      
             httpRequest.open('POST', '/deleteuser', true);

             httpRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

             httpRequest.send("userid="+id);

   
    

           });
           
           $(".tableeditbutton").click(function() {

             console.log("tabledeletebutton clicked");
             
             var id;
             
             id = $(this).attr("userid");
             
             console.log("userid is: " + id);
             
             
             var username = $(this).attr("username");
             
             $("#usernameedit").val( username );
             
             
             var firstname = $(this).attr("firstname");
             
             $("#firstnameedit").val( firstname );
             
             
             var lastname = $(this).attr("lastname");
             
             $("#lastnameedit").val( lastname );


             var name = $(this).attr("name");
             $("#nameedit").val( name );


             
             $("#usereditbutton").attr("id",id);

             
             
      

    

           });
           
           $("#usereditbutton").click(function() {
           
             var httpRequest = new XMLHttpRequest();
      
             if (!httpRequest) 
             {
               alert('Giving up : Cannot create an XMLHTTP instance');
               return false;
             }


              httpRequest.onreadystatechange = function(){
      
                if (httpRequest.readyState === XMLHttpRequest.DONE) 
                {

                  if (httpRequest.status === 200) 
                  {


                    location.reload(true);


                  }


                }


              }
           
             httpRequest.open('POST', '/edituser', true);

             httpRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
             
             var usernametosend = $("#usernameedit").val();
             var firstnametosend = $("#firstnameedit").val();
             var lastnametosend = $("#lastnameedit").val();

             var nametosend = $("#nameedit").val();

             


             var passwordtosend = $("#passwordedit").val();

             console.log("nametosend: " + nametosend);
             console.log("passwordtosend: " + passwordtosend);
             console.log("usernametosend: " + usernametosend);

             
             var id;
             id = $(this).attr("id");
             
             //httpRequest.send("userid="+ id);
             httpRequest.send("userid="+ id + "&username=" + usernametosend + "&name=" + nametosend  + "&password=" + passwordtosend );

                   
           
           });
            
           //$("#usertable").append("<th scope=row>" + arr[i].id + "</th>" +  "<td>" + arr[i].username+ "</td>");
            
           /* 
                      <th scope="row">1</th>
          <td>Mark</td>
          <td>Otto</td>
          <td>@mdo</td>
          <td>button</td>
          <td>button</td>
          */
            
            console.log(">>>" + arr[0].username);
            
          } 
      
          else 
      
      
          {
      
            alert('There was a problem with the request.');
       
          }
          
        }
        
      }


      
      httpRequest.open('POST', '/retrieveuserlist', true);
      
      httpRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
      
      httpRequest.send();
      
      

    });

  
  </script>


  <body>
  
    <h1>{{title}}</h1>
   

    
    <div class="btn-group" role="group" aria-label="...">
      <a href="/logout" class="btn btn-default">Log Out</a>
      <a href="/userSettings" class="btn btn-default">User Settings</a>
      <a href="/chart" class="btn btn-default">Chart</a>
      <a href="/reports" class="btn btn-default">Reports</a>

      
    </div>
    
    <br>
    <br>
    
    <h2>Create User:</h2>
    
    <br>
    <br>

    <!--
    
    <div class="input-group">
      
      <span class="input-group-addon" id="basic-addon1">@</span>
      <input type="text" class="form-control" placeholder="User Name" aria-describedby="basic-addon1" id="username">
    </div>
    
    <div class="input-group">
      <span class="input-group-addon" id="basic-addon1">@</span>
      <input type="password" class="form-control" placeholder="Password" aria-describedby="basic-addon1" id="password">
    </div>
    
    <div class="input-group">
      
      <span class="input-group-addon" id="basic-addon1">@</span>
      <input type="text" class="form-control" placeholder="Name" aria-describedby="basic-addon1" id="name">
    </div>
    

    
    <label class="control-label">User Signature Image File</label>
    <input type="file" class="form-control" id="signature" name="signature">

    <button type="button" class="btn btn-default" id="createuserbutton">Create User</button>




    -->

    <form action="/register" method="post" enctype="multipart/form-data">
      <div class="form-group">
        <label for="name">Full name</label>
        <input type="text" class="form-control" id="name" name="name" placeholder="Enter full name">
      </div>
      <div class="form-group">
        <label for="username">Email address</label>
        <input type="email" class="form-control" id="username" name="username" placeholder="Enter email">
      </div>
      <div class="form-group">
        <label for="password">Password</label>
        <input type="password" class="form-control" id="password" name="password" placeholder="Password">
      </div>
      <div class="form-group">
        <label for="signature">Upload signature file</label>
        <input type="file" class="form-control" id="signature" name="signature">
      </div>

      <div class="form-group">
        <label for="signature">Is administrator?</label>
        <input type="checkbox" class="form-control" id="isadmin" name="isadmin">
      </div>

    
      <div class="btn-group" role="group" aria-label="...">
        <button type="submit" class="btn btn-primary">Submit</button>
        <!-- <a href="http://localhost:3000/"><button type="button" class="btn btn-default">Back To Index</button></a> -->
      </div>
    </form>



    <br>
    <br>
    
    <h2>Delete User:</h2>
    
    <br>
    <br>
    
    <div class="input-group">
      
      <span class="input-group-addon" id="basic-addon1">@</span>
      <input type="text" class="form-control" placeholder="User Id" aria-describedby="basic-addon1" id="userid">
      
    </div>
    
    <button type="button" class="btn btn-default" id="deleteuserbutton">Delete User</button>
    
    <br>
    <br>
    
    <h2>User List:</h2>
    
    <br>
    <br>
    
    <table class="table">
      <thead>
        <tr>
          <th>Id #</th>
          <th>Is Admin</th>
          <th>User Name</th>
          <th>Name</th>

          <th>Edit</th>
          <th>Delete</th>
        </tr>
      </thead>
      <tbody id="usertable">
        <tr>
          <th scope="row">1</th>
          <td>Mark</td>
          <td>Otto</td>
          <td>@mdo</td>
          <td>button</td>
          <td>button</td>
        </tr>

      </tbody>
    </table>
    
    <br>
    <br>
    <h2>Edit User:</h2>
    <br>
    <br>
    
    <div class="input-group">
      
      <span class="input-group-addon" id="basic-addon1">@</span>
      <input type="text" class="form-control" placeholder="User Name" aria-describedby="basic-addon1" id="usernameedit">
    </div>
    
    <div class="input-group">
      <span class="input-group-addon" id="basic-addon1">@</span>
      <input type="password" class="form-control" placeholder="Password" aria-describedby="basic-addon1" id="passwordedit">
    </div>
    
    <div class="input-group">
      
      <span class="input-group-addon" id="basic-addon1">@</span>
      <input type="text" class="form-control" placeholder="Name" aria-describedby="basic-addon1" id="nameedit">
    </div>
    

    
    <br>

    <button type="button" class="btn btn-default" id="usereditbutton">Edit User</button>

    

  </body>
<html>