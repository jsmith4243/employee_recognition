<html lang="en">

  <title>{{title}}</title>
  
  <link rel ='stylesheet' href='stylesheets/style.css' />
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
  
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
  
  
  
  <script>
  
  
    $(document).ready(function()
    {
    
    


      $("#createuserbutton").click(function() {

        var username = $("#username").val();
        
        var password = $("#password").val();
        
        var firstname = $("#firstname").val();
        
        var lastname = $("#lastname").val();
      
        var httpRequest = new XMLHttpRequest();
      
        if (!httpRequest) 
        {
          alert('Giving up : Cannot create an XMLHTTP instance');
          return false;
        }
      
        httpRequest.open('POST', '/register', true);

        httpRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

        httpRequest.send("username="+username+"&password="+password+"&firstname="+firstname+"&lastname="+lastname); //post attributes here, id is a javascript variable appended

   
    

      });
      
      $("#deleteuserbutton").click(function() {

        var userid = $("#userid").val();
      
        var httpRequest = new XMLHttpRequest();
      
        if (!httpRequest) 
        {
          alert('Giving up : Cannot create an XMLHTTP instance');
          return false;
        }
      
        httpRequest.open('POST', '/deleteuser', true);

        httpRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

        httpRequest.send("userid="+userid);

   
    

      });
      
      var httpRequest = new XMLHttpRequest();
      
      if (!httpRequest) 
      {
          alert('Giving up : Cannot create an XMLHTTP instance');
          return false;
      }
      
      httpRequest.onreadystatechange = function(){
      
        if (httpRequest.readyState === XMLHttpRequest.DONE) 
        {

          if (httpRequest.status === 200) 
          {
          
            //alert(httpRequest.responseText); //if its json you call JSON parse to get a json object which is same as javascript object
            var arr = JSON.parse(httpRequest.responseText);
            
           $("#usertable").empty();
           
           var examplefirstname = "examplefirstname";
           var examplelastname = "examplelastname";
           
           
           for(i = 0; i < arr.length; i++)
           {
             $("#usertable").append("<tr>" + "<th scope=row>" + arr[i].id + "</th>" +  "<td>" + arr[i].username + "</td>" + "<td>" + examplefirstname + "</td>" + "<td>" + examplelastname + "</td>" + "<td><button type=\"button\" class=\"btn btn-default tableeditbutton\"  userid=\"" + arr[i].id + "\"   id=\"tableeditbutton\" username=\"" + arr[i].username + "\" firstname=\"" + arr[i].firstname + "\" lastname=\"" + arr[i].lastname + "\" >Edit</button></td>" + "<td><button type=\"button\" class=\"btn btn-default tabledeletebutton\" userid=\"" + arr[i].id + "\"  id=\"tabledeletebutton\" >Delete</button></td>" +  "</tr>");
           }
           
           $(".tabledeletebutton").click(function() {

             console.log("tabledeletebutton clicked");
             
             var id;
             
             id = $(this).attr("userid");
             
             console.log("userid is: " + id);
             
             
             
             var httpRequest = new XMLHttpRequest();
      
             if (!httpRequest) 
             {
               alert('Giving up : Cannot create an XMLHTTP instance');
               return false;
             }
      
             httpRequest.open('POST', '/deleteuser', true);

             httpRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");

             httpRequest.send("userid="+id);

   
    

           });
           
           $(".tableeditbutton").click(function() {

             console.log("tabledeletebutton clicked");
             
             var id;
             
             id = $(this).attr("userid");
             
             console.log("userid is: " + id);
             
             
             var username = $(this).attr("username");
             
             $("#usernameedit").val( username );
             
             
             var firstname = $(this).attr("firstname");
             
             $("#firstnameedit").val( firstname );
             
             
             var lastname = $(this).attr("lastname");
             
             $("#lastnameedit").val( lastname );
             
             $("#usereditbutton").attr("id",id);

             
             
      

    

           });
           
           $("#usereditbutton").click(function() {
           
             var httpRequest = new XMLHttpRequest();
      
             if (!httpRequest) 
             {
               alert('Giving up : Cannot create an XMLHTTP instance');
               return false;
             }
           
             httpRequest.open('POST', '/edituser', true);

             httpRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
             
             var usernametosend = $("#usernameedit").val();
             var firstnametosend = $("#firstnameedit").val();
             var lastnametosend = $("#lastnameedit").val();
             
             var id;
             id = $(this).attr("id");
             
             //httpRequest.send("userid="+ id);
             httpRequest.send("userid="+ id + "&username=" + usernametosend + "&firstname=" + firstnametosend  + "&lastname=" + lastnametosend );

                   
           
           });
            
           //$("#usertable").append("<th scope=row>" + arr[i].id + "</th>" +  "<td>" + arr[i].username+ "</td>");
            
           /* 
                      <th scope="row">1</th>
          <td>Mark</td>
          <td>Otto</td>
          <td>@mdo</td>
          <td>button</td>
          <td>button</td>
          */
            
            console.log(">>>" + arr[0].username);
            
          } 
      
          else 
      
      
          {
      
            alert('There was a problem with the request.');
       
          }
          
        }
        
      }


      
      httpRequest.open('POST', '/retrieveuserlist', true);
      
      httpRequest.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
      
      httpRequest.send();
      
      

    });

  
  </script>


  <body>
  
    <h1>{{title}}</h1>
   

    
    <div class="btn-group" role="group" aria-label="...">
      <a href="http://localhost:3000/"><button type="button" class="btn btn-default">Log Out</button></a>
      <a href="http://localhost:3000/userSettings"><button type="button" class="btn btn-default">User Settings</button></a>
      
    </div>
    
    <br>
    <br>
    
    <h2>Create User:</h2>
    
    <br>
    <br>
    
    <div class="input-group">
      
      <span class="input-group-addon" id="basic-addon1">@</span>
      <input type="text" class="form-control" placeholder="User Name" aria-describedby="basic-addon1" id="username">
    </div>
    
    <div class="input-group">
      <span class="input-group-addon" id="basic-addon1">@</span>
      <input type="password" class="form-control" placeholder="Password" aria-describedby="basic-addon1" id="password">
    </div>
    
    <div class="input-group">
      
      <span class="input-group-addon" id="basic-addon1">@</span>
      <input type="text" class="form-control" placeholder="First Name" aria-describedby="basic-addon1" id="firstname">
    </div>
    
    <div class="input-group">
      
      <span class="input-group-addon" id="basic-addon1">@</span>
      <input type="text" class="form-control" placeholder="Last Name" aria-describedby="basic-addon1" id="lastname">
    </div>
    
    <label class="control-label">User Signature Image File</label>
    <input id="input-1" type="file" class="file">

    <button type="button" class="btn btn-default" id="createuserbutton">Create User</button>




    <br>
    <br>
    
    <h2>Delete User:</h2>
    
    <br>
    <br>
    
    <div class="input-group">
      
      <span class="input-group-addon" id="basic-addon1">@</span>
      <input type="text" class="form-control" placeholder="User Id" aria-describedby="basic-addon1" id="userid">
      
    </div>
    
    <button type="button" class="btn btn-default" id="deleteuserbutton">Delete User</button>
    
    <br>
    <br>
    
    <h2>User List:</h2>
    
    <br>
    <br>
    
    <table class="table">
      <thead>
        <tr>
          <th>Id #</th>
          <th>User Name</th>
          <th>First Name</th>
          <th>Last Name</th>
          <th>Edit</th>
          <th>Delete</th>
        </tr>
      </thead>
      <tbody id="usertable">
        <tr>
          <th scope="row">1</th>
          <td>Mark</td>
          <td>Otto</td>
          <td>@mdo</td>
          <td>button</td>
          <td>button</td>
        </tr>

      </tbody>
    </table>
    
    <br>
    <br>
    <h2>Edit User:</h2>
    <br>
    <br>
    
    <div class="input-group">
      
      <span class="input-group-addon" id="basic-addon1">@</span>
      <input type="text" class="form-control" placeholder="User Name" aria-describedby="basic-addon1" id="usernameedit">
    </div>
    
    <div class="input-group">
      <span class="input-group-addon" id="basic-addon1">@</span>
      <input type="password" class="form-control" placeholder="Password" aria-describedby="basic-addon1" id="passwordedit">
    </div>
    
    <div class="input-group">
      
      <span class="input-group-addon" id="basic-addon1">@</span>
      <input type="text" class="form-control" placeholder="First Name" aria-describedby="basic-addon1" id="firstnameedit">
    </div>
    
    <div class="input-group">
      
      <span class="input-group-addon" id="basic-addon1">@</span>
      <input type="text" class="form-control" placeholder="Last Name" aria-describedby="basic-addon1" id="lastnameedit">
    </div>
    
    <label class="control-label">User Signature Image File</label>
    <input id="input-1edit" type="file" class="file">

    <button type="button" class="btn btn-default" id="usereditbutton">Edit User</button>

    

  </body>
<html>